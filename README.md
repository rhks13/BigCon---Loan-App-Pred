## 빅콘테스트
# 대출신청 예측분석 및 고객유형 군집화

## 분석 배경
+ 2021년 기준 대출 보유자 수는 약 2000만명 -> 모두에게 불가피한 영역
+ 가계부채 비율의 증가, 최근 금리인상의 변동 -> 가계 부실 야기
+ finda의 목표 : 잘 빌리고 잘 갚을 수 있는 대출 생태계의 구축
  + 최적의 상품을 연결하는 것이 수익구조에 직접적인 영향
+ 최종 대출신청을 하는 고객의 특성을 발견하고, 고객의 군집별 경향성을 분석해 추가적인 인사이트를 도출하고자 노력
  + 앱 로그 데이터를 적극 활용할 것
  
# 1. 대출신청 예측 분석

## 1-1. 데이터 EDA & 전처리

### 대출상품 조회 과정

![image](https://user-images.githubusercontent.com/69777594/230568983-7f7da61d-8e18-4ac1-87fc-8378d2902e39.png)

1. user의 대출한도 조회 -> application id 한 개 생성
2. user의 정보 기반으로 다양한 대출상품 제시 

### 데이터 추가 및 병합
+ 신청서 ID, 유저 ID를 기준으로 테이블 병합
+ economy indicators 추가 : 전반적인 거시경제상황의 영향 추가

### 로그 빈도 변수 생성
+ user log data를 바탕으로 유저 개인의 앱 사용 성향에 관한 내용을 반영하고자 함
+ 해당 유저가 신청서를 넣기 전까지의 로그 이벤트 별 빈도를 새로운 변수로 생성
  ![image](https://user-images.githubusercontent.com/69777594/230569297-df0ad04f-3a5a-4ff6-82a6-32e07f48ecab.png)

### 파생 변수 생성
+ sign up : 가입일 활용 -> 신규 가입자와 기존 가입자의 분리
+ user age, working month, sign month : 단순 연산을 통해 더욱 직관적인 numeric으로 변형
+ user interest : 요구 금액, 제공 이율 활용 -> 실제로 유저가 부담해야하는 이자액 
+ PCA 
  + 이벤트 별 로그 빈도 변수 경향이 유사 => pca를 통해 차원축소
  + 경제 변수들을 차원축소 시켜 적은 변수로 설명 가능케 함
  
### 결측치 처리
+ 결측 비율, 변수 특성에 알맞은 처리방법 적용
+ 결측 비율 5% 미만 : 해당 행 제거
+ 개인 회생 관련 변수 : 두 변수 값의 조합으로 새로운 변수 생성
+ 신용 점수 : Iterative imputer를 사용한 대체

## 1-2. 모델링

### 모델 선정
+ Catboost Classifier : 범주형 자료 처리에 용이

### Sampling
+ 전체 데이터 수 : 10270011 (loan_reasult 기준) / 269328 (User 수 기준)
+ 5% 랜덤샘플링을 통해 보다 실용적으로 데이터 활용 (train/test size 유지)

### 불균형성 해소
+ cost sensitive learning : 클래스의 개수를 반영해 모델에 가중치 부여
+ 모델의 하이퍼 파라미터에 계산한 가중치 삽입

### 모델 해석
+ SHAP : 변수 간 의존성까지 포함한 모델 결과 해석을 가능케 함

### 결론
+ User id의 높은 중요도
+ 대출 한도가 높을수록 대출을 신청할 확률이 높아짐
  + 대출한도가 높은 상품을 우선배치 하는 방식이 유저들의 대출 신청을 높일 수 있음
+ 신용등급이 낮을수록, 예상 부담이자액이 낮을수록 대출 신청할 확률이 높음
+ 유저의 로그빈도가 높을수록 대출신청 확률이 높음
  + 앱을 자주 이용하는 유저 대상 맞춤형 광고를 삽입
  + 앱을 자주 이용하지 않는 유저들의 경우 사용성 증대의 방안이 마련되어야
    + 푸시알람, 이벤트 등

# 2. 클러스터링을 통한 Finda 고객유형 군집화

### 유저데이터 생성
  ![image](https://user-images.githubusercontent.com/69777594/230573641-1cff75d9-45bf-4b62-b670-1aeed4b9f715.png)

+ 유저 유니버스 한정 : 로그 데이터 내에 존재하는 user_id로 한정
+ 변수 생성 및 결측치 처리 : 기존 예측 모델 전처리와 유사하게 진행
+ 변수 선택 : Mutual information score 사용해 변수 필터링
+ DTW를 활용한 SOM(자기 조직화 지도)을 바탕으로 log 데이터를 클러스터링해 신규 변수 생성

### K-Prototype 클러스터링
+ 범주형 자료의 비유사도, 연속형 자료의 유클리디안 거리를 함께 비교하여 클러스터링하는 기법
+ elbow method와 실루엣 계수 사용하여 최적의 군집개수 k를 선택

### 군집 결과 시각화 및 해석
+ 연속형 변수 : radar chart

  ![image](https://user-images.githubusercontent.com/69777594/230574771-e7dbc819-e0eb-4042-8224-7a31e1972928.png)
+ 이산형 변수 : stacked bar plot
  ![image](https://user-images.githubusercontent.com/69777594/230574969-b46bb98d-f4c8-4a79-92b8-7c710980c078.png)

+ 로그데이터 : process mining
  ![image](https://user-images.githubusercontent.com/69777594/230575034-cb520bfa-3247-4784-b7a7-713e5471c7a9.png)

